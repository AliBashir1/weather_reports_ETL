2023-07-01 13:07:57:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 13:07:57:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 13:07:57:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 13:07:57:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 13:07:58:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 13:07:58:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 17:08:55:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:08:55:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:08:55:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:08:55:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:08:55:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:08:55:INFO::fetch_most_populated_zipcodes::Completed with results <class 'pandas.core.series.Series'>.
2023-07-01 17:10:53:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 17:10:53:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 17:10:53:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:10:53:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:10:53:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:10:53:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:10:53:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:10:58:INFO::fetch_most_populated_zipcodes::Completed with results <class 'pandas.core.series.Series'>.
2023-07-01 17:10:58:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 17:10:58:DEBUG:Starting new HTTPS connection (1): weatherapi-com.p.rapidapi.com:443
2023-07-01 17:10:59:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99661 HTTP/1.1" 200 None
2023-07-01 17:10:59:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99692 HTTP/1.1" 200 None
2023-07-01 17:10:59:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99504 HTTP/1.1" 200 None
2023-07-01 17:10:59:INFO::fetch_weather_reports::Completed with results <class 'list'>.
2023-07-01 17:44:30:INFO::get_s3_client::None
2023-07-01 17:44:30:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:44:30:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 17:44:30:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:44:30:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 17:44:30:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 17:44:30:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 17:44:30:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 17:44:30:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 17:44:30:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 17:44:30:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 17:44:30:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 17:44:30:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 17:44:30:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 17:44:30:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 17:44:30:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 17:44:30:DEBUG:IMDS ENDPOINT: http://169.254.169.254/
2023-07-01 17:44:30:DEBUG:Looking for credentials via: env
2023-07-01 17:44:30:DEBUG:Looking for credentials via: assume-role
2023-07-01 17:44:30:DEBUG:Looking for credentials via: assume-role-with-web-identity
2023-07-01 17:44:30:DEBUG:Looking for credentials via: sso
2023-07-01 17:44:30:DEBUG:Looking for credentials via: shared-credentials-file
2023-07-01 17:44:30:DEBUG:Looking for credentials via: custom-process
2023-07-01 17:44:30:DEBUG:Looking for credentials via: config-file
2023-07-01 17:44:30:DEBUG:Looking for credentials via: ec2-credentials-file
2023-07-01 17:44:30:DEBUG:Looking for credentials via: boto-config
2023-07-01 17:44:30:DEBUG:Looking for credentials via: container-role
2023-07-01 17:44:30:DEBUG:Looking for credentials via: iam-role
2023-07-01 17:44:30:DEBUG:Starting new HTTP connection (1): 169.254.169.254:80
2023-07-01 17:44:30:DEBUG:Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/api/token: Could not connect to the endpoint URL: "http://169.254.169.254/latest/api/token"
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 465, in send
    urllib_response = conn.urlopen(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1252, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 94, in _send_request
    rval = super()._send_request(
  File "/usr/local/lib/python3.8/http/client.py", line 1298, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1247, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 218, in send
    return super().send(str)
  File "/usr/local/lib/python3.8/http/client.py", line 947, in send
    self.connect()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPConnection object at 0xffff6d0724f0>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/utils.py", line 457, in _fetch_metadata_token
    response = self._session.send(request.prepare())
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 494, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "http://169.254.169.254/latest/api/token"
2023-07-01 17:44:30:DEBUG:Starting new HTTP connection (2): 169.254.169.254:80
2023-07-01 17:44:30:DEBUG:Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/meta-data/iam/security-credentials/: Could not connect to the endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 465, in send
    urllib_response = conn.urlopen(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1252, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 94, in _send_request
    rval = super()._send_request(
  File "/usr/local/lib/python3.8/http/client.py", line 1298, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1247, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 218, in send
    return super().send(str)
  File "/usr/local/lib/python3.8/http/client.py", line 947, in send
    self.connect()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPConnection object at 0xffff6d072d90>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/utils.py", line 510, in _get_request
    response = self._session.send(request.prepare())
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 494, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
2023-07-01 17:44:30:DEBUG:Max number of attempts exceeded (1) when attempting to retrieve data from metadata service.
2023-07-01 17:44:30:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 17:44:30:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 17:44:30:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffff7f4c8700>
2023-07-01 17:44:30:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 17:44:31:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 17:44:31:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 17:44:31:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffff7f57f3a0>
2023-07-01 17:44:31:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffff7f54c9d0>
2023-07-01 17:44:31:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffff7f57f160>
2023-07-01 17:44:31:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 17:44:31:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 17:44:31:DEBUG:Registering retry handlers for service: s3
2023-07-01 17:44:31:DEBUG:Registering S3 region redirector handler
2023-07-01 17:44:31:INFO::get_s3_client::Completed with results <class 'botocore.client.S3'>.
2023-07-01 17:44:31:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 17:44:31:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 17:44:31:INFO::get_mysql_connections::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:44:31:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:44:31:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:44:31:INFO::get_mysql_connections::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:44:31:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:44:31:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:44:31:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:44:31:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:44:31:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:44:31:INFO::fetch_most_populated_zipcodes::Completed with results <class 'pandas.core.series.Series'>.
2023-07-01 17:44:31:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 17:44:31:DEBUG:Starting new HTTPS connection (1): weatherapi-com.p.rapidapi.com:443
2023-07-01 17:44:31:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99661 HTTP/1.1" 200 None
2023-07-01 17:44:32:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99692 HTTP/1.1" 200 None
2023-07-01 17:44:32:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99504 HTTP/1.1" 200 None
2023-07-01 17:44:32:INFO::fetch_weather_reports::Completed with results <class 'list'>.
2023-07-01 17:44:32:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffff7f450dc0>
2023-07-01 17:44:32:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff6c5a3520>>
2023-07-01 17:44:32:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'staging-data-ab', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 17:44:32:DEBUG:Endpoint provider result: https://staging-data-ab.s3.amazonaws.com
2023-07-01 17:44:32:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 17:44:32:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0xffff7f44ea60>
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0xffff7f4dfe50>
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0xffff7f4503a0>
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0xffff7f4dfdc0>
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0xffff7f450c10>
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff6c5a3520>>
2023-07-01 17:44:32:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0xffff7f4dfc10>
2023-07-01 17:44:32:DEBUG:Event before-call.s3.PutObject: calling handler <function conditionally_calculate_md5 at 0xffff7f6c5670>
2023-07-01 17:44:32:DEBUG:Event before-call.s3.PutObject: calling handler <function add_expect_header at 0xffff7f44e160>
2023-07-01 17:44:32:DEBUG:Adding expect 100 continue header to request.
2023-07-01 17:44:32:DEBUG:Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0xffff7f4df8b0>
2023-07-01 17:44:32:DEBUG:Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0xffff7f4504c0>
2023-07-01 17:44:32:DEBUG:Making request for OperationModel(name=PutObject) with params: {'url_path': '/weather-reports/2023-07-01/01-PM', 'query_string': {}, 'method': 'PUT', 'headers': {'x-amz-acl': 'private', 'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'Content-MD5': 'LaWLjC624eZt+Q9kMr9/KA==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0xffff6b591cc0>, 'auth_path': '/staging-data-ab/weather-reports/2023-07-01/01-PM', 'url': 'https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/01-PM', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff6c7b31c0>, 'has_streaming_input': True, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'staging-data-ab', 'params': {'Bucket': 'staging-data-ab', 'Key': 'weather-reports/2023-07-01/01-PM', 'Body': <_io.BytesIO object at 0xffff6b591cc0>, 'ACL': 'private'}}}}
2023-07-01 17:44:32:DEBUG:Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff6c7aae50>>
2023-07-01 17:44:32:DEBUG:Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffff6d0fab50>>
2023-07-01 17:44:32:DEBUG:Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0xffff7f4dfaf0>
2023-07-01 17:44:32:DEBUG:Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0xffff7f450d30>
2023-07-01 13:45:11:INFO::get_s3_client::None
2023-07-01 13:45:11:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 13:45:11:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 13:45:11:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 13:45:11:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 13:45:11:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 13:45:11:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 13:45:11:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 13:45:11:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 13:45:11:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 13:45:11:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 13:45:11:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 13:45:11:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 13:45:11:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 13:45:11:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 13:45:11:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 13:45:11:DEBUG:IMDS ENDPOINT: http://169.254.169.254/
2023-07-01 13:45:11:DEBUG:Looking for credentials via: env
2023-07-01 13:45:11:DEBUG:Looking for credentials via: assume-role
2023-07-01 13:45:11:DEBUG:Looking for credentials via: assume-role-with-web-identity
2023-07-01 13:45:11:DEBUG:Looking for credentials via: sso
2023-07-01 13:45:11:DEBUG:Looking for credentials via: shared-credentials-file
2023-07-01 13:45:11:INFO:Found credentials in shared credentials file: ~/.aws/credentials
2023-07-01 13:45:11:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 13:45:11:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 13:45:11:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x105f04280>
2023-07-01 13:45:11:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 13:45:11:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 13:45:11:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 13:45:11:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x105e2f280>
2023-07-01 13:45:11:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x1377a6d30>
2023-07-01 13:45:11:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x105e2f040>
2023-07-01 13:45:11:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 13:45:11:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 13:45:11:DEBUG:Registering retry handlers for service: s3
2023-07-01 13:45:11:DEBUG:Registering S3 region redirector handler
2023-07-01 13:45:11:INFO::get_s3_client::Completed with results <class 'botocore.client.S3'>.
2023-07-01 13:45:11:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x105f22940>
2023-07-01 13:45:11:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x160272790>>
2023-07-01 13:45:11:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 13:45:11:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 13:45:11:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 13:45:11:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 13:45:11:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x105f1c940>
2023-07-01 13:45:11:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x105f22790>
2023-07-01 13:45:11:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x160272790>>
2023-07-01 13:45:11:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x105f1c790>
2023-07-01 13:45:11:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x105f1cca0>
2023-07-01 13:45:11:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x105f1c430>
2023-07-01 13:45:11:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x105f22040>
2023-07-01 13:45:11:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x1601d6940>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 13:45:11:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x1601d6970>>
2023-07-01 13:45:11:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x1377d8310>>
2023-07-01 13:45:11:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x105f1c670>
2023-07-01 13:45:11:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x105f228b0>
2023-07-01 13:45:11:DEBUG:Calculating signature using v4 auth.
2023-07-01 13:45:11:DEBUG:CanonicalRequest:
PUT
/what_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T174511Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 13:45:11:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T174511Z
20230701/us-east-1/s3/aws4_request
3f72bdba9b414422d3fc0ed9ee5d982bb318f16bf0c2153e4336c182844adc63
2023-07-01 13:45:11:DEBUG:Signature:
61c7642db3fc5c20e28e491b3ac29d895d5a99913eb52b7e271a70a84fc77038
2023-07-01 13:45:11:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x105f22700>
2023-07-01 13:45:11:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T174511Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=61c7642db3fc5c20e28e491b3ac29d895d5a99913eb52b7e271a70a84fc77038', 'amz-sdk-invocation-id': b'433dcd1f-73fb-47b7-8355-b756fd5a4645', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 13:45:11:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 13:45:11:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 13:45:12:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_this HTTP/1.1" 400 None
2023-07-01 13:45:12:DEBUG:Response headers: {'x-amz-request-id': 'YHSYXFBK47K4JEWF', 'x-amz-id-2': 'TTfn5P474uXnZ3ykXN7inw5JDA6+rYza2v5SIk43whOVpEtXTGcqvWTGuuymzQMflsnQw0gJh+0=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 17:45:11 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2023-07-01 13:45:12:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidBucketName</Code><Message>The specified bucket is not valid.</Message><BucketName>what_is_this</BucketName><RequestId>YHSYXFBK47K4JEWF</RequestId><HostId>TTfn5P474uXnZ3ykXN7inw5JDA6+rYza2v5SIk43whOVpEtXTGcqvWTGuuymzQMflsnQw0gJh+0=</HostId></Error>'
2023-07-01 13:45:12:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x160272730>
2023-07-01 13:45:12:DEBUG:No retry needed.
2023-07-01 13:45:12:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x160272790>>
2023-07-01 17:53:40:INFO::get_s3_client::None
2023-07-01 17:53:40:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:53:40:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 17:53:40:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:53:40:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 17:53:40:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 17:53:40:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 17:53:40:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 17:53:40:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 17:53:40:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 17:53:40:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 17:53:40:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 17:53:40:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 17:53:40:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 17:53:40:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 17:53:40:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 17:53:40:DEBUG:IMDS ENDPOINT: http://169.254.169.254/
2023-07-01 17:53:40:DEBUG:Looking for credentials via: env
2023-07-01 17:53:40:DEBUG:Looking for credentials via: assume-role
2023-07-01 17:53:40:DEBUG:Looking for credentials via: assume-role-with-web-identity
2023-07-01 17:53:40:DEBUG:Looking for credentials via: sso
2023-07-01 17:53:40:DEBUG:Looking for credentials via: shared-credentials-file
2023-07-01 17:53:40:DEBUG:Looking for credentials via: custom-process
2023-07-01 17:53:40:DEBUG:Looking for credentials via: config-file
2023-07-01 17:53:40:DEBUG:Looking for credentials via: ec2-credentials-file
2023-07-01 17:53:40:DEBUG:Looking for credentials via: boto-config
2023-07-01 17:53:40:DEBUG:Looking for credentials via: container-role
2023-07-01 17:53:40:DEBUG:Looking for credentials via: iam-role
2023-07-01 17:53:40:DEBUG:Starting new HTTP connection (1): 169.254.169.254:80
2023-07-01 17:53:40:DEBUG:Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/api/token: Could not connect to the endpoint URL: "http://169.254.169.254/latest/api/token"
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 465, in send
    urllib_response = conn.urlopen(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1252, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 94, in _send_request
    rval = super()._send_request(
  File "/usr/local/lib/python3.8/http/client.py", line 1298, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1247, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 218, in send
    return super().send(str)
  File "/usr/local/lib/python3.8/http/client.py", line 947, in send
    self.connect()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPConnection object at 0xffffa2602d60>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/utils.py", line 457, in _fetch_metadata_token
    response = self._session.send(request.prepare())
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 494, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "http://169.254.169.254/latest/api/token"
2023-07-01 17:53:40:DEBUG:Starting new HTTP connection (2): 169.254.169.254:80
2023-07-01 17:53:40:DEBUG:Caught retryable HTTP exception while making metadata service request to http://169.254.169.254/latest/meta-data/iam/security-credentials/: Could not connect to the endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 174, in _new_conn
    conn = connection.create_connection(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 95, in create_connection
    raise err
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/connection.py", line 85, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 465, in send
    urllib_response = conn.urlopen(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 787, in urlopen
    retries = retries.increment(
  File "/usr/local/lib/python3.8/site-packages/urllib3/util/retry.py", line 525, in increment
    raise six.reraise(type(error), error, _stacktrace)
  File "/usr/local/lib/python3.8/site-packages/urllib3/packages/six.py", line 770, in reraise
    raise value
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 703, in urlopen
    httplib_response = self._make_request(
  File "/usr/local/lib/python3.8/site-packages/urllib3/connectionpool.py", line 398, in _make_request
    conn.request(method, url, **httplib_request_kw)
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 244, in request
    super(HTTPConnection, self).request(method, url, body=body, headers=headers)
  File "/usr/local/lib/python3.8/http/client.py", line 1252, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 94, in _send_request
    rval = super()._send_request(
  File "/usr/local/lib/python3.8/http/client.py", line 1298, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "/usr/local/lib/python3.8/http/client.py", line 1247, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 123, in _send_output
    self.send(msg)
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/awsrequest.py", line 218, in send
    return super().send(str)
  File "/usr/local/lib/python3.8/http/client.py", line 947, in send
    self.connect()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 205, in connect
    conn = self._new_conn()
  File "/usr/local/lib/python3.8/site-packages/urllib3/connection.py", line 186, in _new_conn
    raise NewConnectionError(
urllib3.exceptions.NewConnectionError: <botocore.awsrequest.AWSHTTPConnection object at 0xffffa261bc10>: Failed to establish a new connection: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/utils.py", line 510, in _get_request
    response = self._session.send(request.prepare())
  File "/usr/local/airflow/.local/lib/python3.8/site-packages/botocore/httpsession.py", line 494, in send
    raise EndpointConnectionError(endpoint_url=request.url, error=e)
botocore.exceptions.EndpointConnectionError: Could not connect to the endpoint URL: "http://169.254.169.254/latest/meta-data/iam/security-credentials/"
2023-07-01 17:53:40:DEBUG:Max number of attempts exceeded (1) when attempting to retrieve data from metadata service.
2023-07-01 17:53:40:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 17:53:40:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 17:53:40:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffffb423b670>
2023-07-01 17:53:40:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 17:53:40:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 17:53:40:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 17:53:40:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffffb42933a0>
2023-07-01 17:53:40:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffffa2642790>
2023-07-01 17:53:40:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffffb4293160>
2023-07-01 17:53:40:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 17:53:40:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 17:53:40:DEBUG:Registering retry handlers for service: s3
2023-07-01 17:53:40:DEBUG:Registering S3 region redirector handler
2023-07-01 17:53:40:INFO::get_s3_client::Completed with results <class 'botocore.client.S3'>.
2023-07-01 17:53:40:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffffb41c4d30>
2023-07-01 17:53:40:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffffa1bceb50>>
2023-07-01 17:53:40:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 17:53:40:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 17:53:40:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 17:53:40:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 17:53:40:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0xffffb41bad30>
2023-07-01 17:53:40:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0xffffb41c4b80>
2023-07-01 17:53:40:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffffa1bceb50>>
2023-07-01 17:53:40:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0xffffb41bab80>
2023-07-01 17:53:40:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0xffffb41c30d0>
2023-07-01 17:53:40:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0xffffb41ba820>
2023-07-01 17:53:40:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0xffffb41c4430>
2023-07-01 17:53:40:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffffa1c3b040>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 17:53:40:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffffa1c36ca0>>
2023-07-01 17:53:40:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffa25f1400>>
2023-07-01 17:53:40:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffffb41baa60>
2023-07-01 17:53:40:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffffb41c4ca0>
2023-07-01 13:58:30:INFO::get_s3_client::None
2023-07-01 13:58:30:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 13:58:30:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 13:58:30:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 13:58:30:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 13:58:30:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 13:58:30:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 13:58:30:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 13:58:30:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 13:58:30:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 13:58:30:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 13:58:30:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 13:58:30:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 13:58:30:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 13:58:30:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 13:58:30:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 13:58:30:DEBUG:IMDS ENDPOINT: http://169.254.169.254/
2023-07-01 13:58:30:DEBUG:Looking for credentials via: env
2023-07-01 13:58:30:DEBUG:Looking for credentials via: assume-role
2023-07-01 13:58:30:DEBUG:Looking for credentials via: assume-role-with-web-identity
2023-07-01 13:58:30:DEBUG:Looking for credentials via: sso
2023-07-01 13:58:30:DEBUG:Looking for credentials via: shared-credentials-file
2023-07-01 13:58:30:INFO:Found credentials in shared credentials file: ~/.aws/credentials
2023-07-01 13:58:30:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 13:58:30:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 13:58:30:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x101466280>
2023-07-01 13:58:31:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 13:58:31:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 13:58:31:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 13:58:31:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x1013a7280>
2023-07-01 13:58:31:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x11133fd30>
2023-07-01 13:58:31:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x1013a7040>
2023-07-01 13:58:31:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 13:58:31:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 13:58:31:DEBUG:Registering retry handlers for service: s3
2023-07-01 13:58:31:DEBUG:Registering S3 region redirector handler
2023-07-01 13:58:31:INFO::get_s3_client::Completed with results <class 'botocore.client.S3'>.
2023-07-01 13:58:31:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x1014ad940>
2023-07-01 13:58:31:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x111dc57c0>>
2023-07-01 13:58:31:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 13:58:31:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 13:58:31:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 13:58:31:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 13:58:31:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x1014a5940>
2023-07-01 13:58:31:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x1014ad790>
2023-07-01 13:58:31:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x111dc57c0>>
2023-07-01 13:58:31:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x1014a5790>
2023-07-01 13:58:31:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x1014a5ca0>
2023-07-01 13:58:31:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x1014a5430>
2023-07-01 13:58:31:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x1014ad040>
2023-07-01 13:58:31:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x111c69940>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 13:58:31:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x111c69970>>
2023-07-01 13:58:31:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x111370310>>
2023-07-01 13:58:31:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x1014a5670>
2023-07-01 13:58:31:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x1014ad8b0>
2023-07-01 13:58:31:DEBUG:Calculating signature using v4 auth.
2023-07-01 13:58:31:DEBUG:CanonicalRequest:
PUT
/what_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T175831Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 13:58:31:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T175831Z
20230701/us-east-1/s3/aws4_request
e0b10aebff9db3d3d9fe110b325a3c5e47c5a17bf92215edea5d7c8603f6f566
2023-07-01 13:58:31:DEBUG:Signature:
ff72c40b1f49534810d592a1df981add7f3a3e208ed82a74280356ddc642eed1
2023-07-01 13:58:31:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x1014ad700>
2023-07-01 13:58:31:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T175831Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=df/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=ff72c40b1f49534810d592a1df981add7f3a3e208ed82a74280356ddc642eed1', 'amz-sdk-invocation-id': b'ea65dfac-7cbc-40d0-86bd-ca3786396680', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 13:58:31:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 13:58:31:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 13:58:31:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_this HTTP/1.1" 403 None
2023-07-01 13:58:31:DEBUG:Response headers: {'x-amz-request-id': 'XZNWNV6JCM3QW8VQ', 'x-amz-id-2': 'OTMaUjKK2wQiIVmaK+7dj2Nd5oR7J5is/gdWys7q/A1X+SgfiS9zW3igGlyEyfo9xcwvBEniHpM=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 17:58:31 GMT', 'Server': 'AmazonS3'}
2023-07-01 13:58:31:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidAccessKeyId</Code><Message>The AWS Access Key Id you provided does not exist in our records.</Message><AWSAccessKeyId>df</AWSAccessKeyId><RequestId>XZNWNV6JCM3QW8VQ</RequestId><HostId>OTMaUjKK2wQiIVmaK+7dj2Nd5oR7J5is/gdWys7q/A1X+SgfiS9zW3igGlyEyfo9xcwvBEniHpM=</HostId></Error>'
2023-07-01 13:58:31:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x111dc5760>
2023-07-01 13:58:31:DEBUG:No retry needed.
2023-07-01 13:58:31:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x111dc57c0>>
2023-07-01 14:37:16:INFO::get_s3_client::None
2023-07-01 14:37:16:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 14:37:16:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 14:37:16:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 14:37:16:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 14:37:16:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 14:37:16:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 14:37:16:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 14:37:16:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 14:37:16:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 14:37:16:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 14:37:16:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 14:37:16:DEBUG:IMDS ENDPOINT: http://169.254.169.254/
2023-07-01 14:37:16:DEBUG:Looking for credentials via: env
2023-07-01 14:37:16:DEBUG:Looking for credentials via: assume-role
2023-07-01 14:37:16:DEBUG:Looking for credentials via: assume-role-with-web-identity
2023-07-01 14:37:16:DEBUG:Looking for credentials via: sso
2023-07-01 14:37:16:DEBUG:Looking for credentials via: shared-credentials-file
2023-07-01 14:37:16:INFO:Found credentials in shared credentials file: ~/.aws/credentials
2023-07-01 14:37:16:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 14:37:16:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 14:37:16:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x101d37280>
2023-07-01 14:37:16:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 14:37:16:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 14:37:16:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 14:37:16:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x101c76280>
2023-07-01 14:37:16:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x116f3ed30>
2023-07-01 14:37:16:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x101c76040>
2023-07-01 14:37:16:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 14:37:16:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 14:37:16:DEBUG:Registering retry handlers for service: s3
2023-07-01 14:37:16:DEBUG:Registering S3 region redirector handler
2023-07-01 14:37:16:INFO::get_s3_client::Completed with results <class 'botocore.client.S3'>.
2023-07-01 14:37:16:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x101d7d940>
2023-07-01 14:37:16:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x117af1820>>
2023-07-01 14:37:16:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 14:37:16:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 14:37:16:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 14:37:16:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 14:37:16:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x101d75940>
2023-07-01 14:37:16:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x101d7d790>
2023-07-01 14:37:16:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x117af1820>>
2023-07-01 14:37:16:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x101d75790>
2023-07-01 14:37:16:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x101d75ca0>
2023-07-01 14:37:16:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x101d75430>
2023-07-01 14:37:16:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x101d7d040>
2023-07-01 14:37:16:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x1179959a0>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 14:37:16:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x1179959d0>>
2023-07-01 14:37:16:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x116f70340>>
2023-07-01 14:37:16:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x101d75670>
2023-07-01 14:37:16:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x101d7d8b0>
2023-07-01 14:37:16:DEBUG:Calculating signature using v4 auth.
2023-07-01 14:37:16:DEBUG:CanonicalRequest:
PUT
/what_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T183716Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 14:37:16:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T183716Z
20230701/us-east-1/s3/aws4_request
6d4f229b2b7046d1090573e9d584639f891bcd91aa5b19321a3591c8393498e0
2023-07-01 14:37:16:DEBUG:Signature:
06d762f84567ff2b2aa2e3a0ed2e77e5bb4b5aea57512294b88fa4cf73fc5844
2023-07-01 14:37:16:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x101d7d700>
2023-07-01 14:37:16:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T183716Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=06d762f84567ff2b2aa2e3a0ed2e77e5bb4b5aea57512294b88fa4cf73fc5844', 'amz-sdk-invocation-id': b'16db4af3-4756-4867-ab6c-0d774969a8f5', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 14:37:16:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 14:37:16:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 14:37:16:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_this HTTP/1.1" 400 None
2023-07-01 14:37:16:DEBUG:Response headers: {'x-amz-request-id': 'N77YTKEE1JY5RT26', 'x-amz-id-2': 'C9xCyeUSbpi7RyCeeMGrZkTJNc44uMYaB4yUcvqlV4poZuS+wVrEKBr1QsYhOHDCdqeJ4/4LSME=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 18:37:16 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2023-07-01 14:37:16:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidBucketName</Code><Message>The specified bucket is not valid.</Message><BucketName>what_is_this</BucketName><RequestId>N77YTKEE1JY5RT26</RequestId><HostId>C9xCyeUSbpi7RyCeeMGrZkTJNc44uMYaB4yUcvqlV4poZuS+wVrEKBr1QsYhOHDCdqeJ4/4LSME=</HostId></Error>'
2023-07-01 14:37:16:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x117af17c0>
2023-07-01 14:37:16:DEBUG:No retry needed.
2023-07-01 14:37:16:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x117af1820>>
2023-07-01 19:04:30:INFO::get_s3_client::None
2023-07-01 19:04:30:DEBUG::get_s3_client::message::No section: 'AWS'
2023-07-01 19:05:04:INFO::get_s3_client::None
2023-07-01 19:05:04:DEBUG::get_s3_client::message::No section: 'AWS'
2023-07-01 19:05:28:INFO::get_s3_client::None
2023-07-01 19:05:28:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:05:28:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 19:05:28:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:05:28:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 19:05:28:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 19:07:23:INFO::get_s3_client::None
2023-07-01 19:07:23:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:07:23:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 19:07:23:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:07:23:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 19:07:23:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 19:07:31:INFO::get_s3_client::None
2023-07-01 19:07:31:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:07:31:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 19:07:31:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:07:31:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 19:07:31:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 15:12:54:INFO::get_s3_client::None
2023-07-01 15:12:54:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:12:54:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:12:54:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:12:54:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:12:54:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 15:14:12:INFO::get_s3_client::None
2023-07-01 15:14:12:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 15:20:38:INFO::get_s3_client::None
2023-07-01 15:20:38:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:20:38:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:20:38:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 15:21:27:INFO::get_s3_client::None
2023-07-01 15:21:27:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:21:27:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:21:27:DEBUG::get_s3_client::message::Got unexpected keyword argument 'aws_access_key_id'
2023-07-01 15:21:58:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:21:58:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:22:19:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:22:19:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:23:28:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:23:28:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:23:28:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 15:23:28:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 15:23:28:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 15:23:28:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 15:23:28:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 15:23:28:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 15:23:28:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 15:23:28:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 15:23:28:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 15:23:28:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 15:23:28:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 15:23:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 15:23:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 15:23:28:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x1025fa280>
2023-07-01 15:23:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 15:23:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 15:23:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 15:23:28:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x10253a280>
2023-07-01 15:23:28:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x122e22ca0>
2023-07-01 15:23:28:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x10253a040>
2023-07-01 15:23:28:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 15:23:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 15:23:28:DEBUG:Registering retry handlers for service: s3
2023-07-01 15:23:28:DEBUG:Registering S3 region redirector handler
2023-07-01 15:23:28:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x102641940>
2023-07-01 15:23:28:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x1238a09d0>>
2023-07-01 15:23:28:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 15:23:28:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 15:23:28:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 15:23:28:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 15:23:28:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x102639940>
2023-07-01 15:23:28:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x102641790>
2023-07-01 15:23:28:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x1238a09d0>>
2023-07-01 15:23:28:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x102639790>
2023-07-01 15:23:28:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x102639ca0>
2023-07-01 15:23:28:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x102639430>
2023-07-01 15:23:28:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x102641040>
2023-07-01 15:23:28:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x1236f3250>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 15:23:28:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x1236f3280>>
2023-07-01 15:23:28:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x122e542e0>>
2023-07-01 15:23:28:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x102639670>
2023-07-01 15:23:28:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x1026418b0>
2023-07-01 15:23:28:DEBUG:Calculating signature using v4 auth.
2023-07-01 15:23:28:DEBUG:CanonicalRequest:
PUT
/what_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T192328Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 15:23:28:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T192328Z
20230701/us-east-1/s3/aws4_request
4c03f6e981b01225a068b1d17a0f62feea10cc63195444e6753e7b842b7404c8
2023-07-01 15:23:28:DEBUG:Signature:
16a853154af125a335e5848bdfabd64064c98810e7275ebc72f63d53c8f40bbc
2023-07-01 15:23:28:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x102641700>
2023-07-01 15:23:28:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T192328Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=gAAAAABkUXOGzm_zj82OjF7tFXJjMUnXwlyHpGO7du8Rr5mVLMbO7vfuOT9ENEyrOkBRB9j8Wg0U0UONrjBbMsWUw8tpZEVqrCzZ0sXFA-4Z-W4Gq1STspY=/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=16a853154af125a335e5848bdfabd64064c98810e7275ebc72f63d53c8f40bbc', 'amz-sdk-invocation-id': b'43c1b91a-607a-4969-8b5e-ea25321ea385', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 15:23:28:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 15:23:28:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 15:23:28:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_this HTTP/1.1" 400 None
2023-07-01 15:23:28:DEBUG:Response headers: {'x-amz-request-id': '5K8Q3X16CEF8T3DY', 'x-amz-id-2': 'Rz/useAm9HlRdFVD6sd1wBRwbdF4DzKpcYc6k9+SHl01pOZ0CbT54qGdSC4Q4tukmY6ctTRDLyk=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 19:23:27 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2023-07-01 15:23:28:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>AuthorizationHeaderMalformed</Code><Message>The authorization header is malformed; the authorization component "Credential=gAAAAABkUXOGzm_zj82OjF7tFXJjMUnXwlyHpGO7du8Rr5mVLMbO7vfuOT9ENEyrOkBRB9j8Wg0U0UONrjBbMsWUw8tpZEVqrCzZ0sXFA-4Z-W4Gq1STspY=/20230701/us-east-1/s3/aws4_request" is malformed.</Message><RequestId>5K8Q3X16CEF8T3DY</RequestId><HostId>Rz/useAm9HlRdFVD6sd1wBRwbdF4DzKpcYc6k9+SHl01pOZ0CbT54qGdSC4Q4tukmY6ctTRDLyk=</HostId></Error>'
2023-07-01 15:23:28:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x1238a0970>
2023-07-01 15:23:28:DEBUG:No retry needed.
2023-07-01 15:23:28:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x1238a09d0>>
2023-07-01 15:24:03:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:24:03:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:24:03:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:24:03:DEBUG::__decrypt::message::encoding without a string argument
2023-07-01 15:24:03:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 15:24:03:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 15:24:03:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 15:24:03:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 15:24:03:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 15:24:03:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 15:24:03:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 15:24:03:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 15:24:03:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 15:24:03:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 15:24:03:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 15:24:03:DEBUG:IMDS ENDPOINT: http://169.254.169.254/
2023-07-01 15:24:03:DEBUG:Looking for credentials via: env
2023-07-01 15:24:03:DEBUG:Looking for credentials via: assume-role
2023-07-01 15:24:03:DEBUG:Looking for credentials via: assume-role-with-web-identity
2023-07-01 15:24:03:DEBUG:Looking for credentials via: sso
2023-07-01 15:24:03:DEBUG:Looking for credentials via: shared-credentials-file
2023-07-01 15:24:03:INFO:Found credentials in shared credentials file: ~/.aws/credentials
2023-07-01 15:24:03:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 15:24:03:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 15:24:03:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x105fb6280>
2023-07-01 15:24:03:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 15:24:03:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 15:24:03:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 15:24:03:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x105ef6280>
2023-07-01 15:24:03:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x117d5fca0>
2023-07-01 15:24:03:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x105ef6040>
2023-07-01 15:24:03:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 15:24:03:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 15:24:03:DEBUG:Registering retry handlers for service: s3
2023-07-01 15:24:03:DEBUG:Registering S3 region redirector handler
2023-07-01 15:24:03:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x105ffd940>
2023-07-01 15:24:03:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x1260f0760>>
2023-07-01 15:24:03:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 15:24:03:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 15:24:03:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 15:24:03:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 15:24:03:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x105ff5940>
2023-07-01 15:24:03:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x105ffd790>
2023-07-01 15:24:03:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x1260f0760>>
2023-07-01 15:24:03:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x105ff5790>
2023-07-01 15:24:03:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x105ff5ca0>
2023-07-01 15:24:03:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x105ff5430>
2023-07-01 15:24:03:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x105ffd040>
2023-07-01 15:24:03:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x125f958e0>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 15:24:03:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x125f95910>>
2023-07-01 15:24:03:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x117d902e0>>
2023-07-01 15:24:03:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x105ff5670>
2023-07-01 15:24:03:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x105ffd8b0>
2023-07-01 15:24:03:DEBUG:Calculating signature using v4 auth.
2023-07-01 15:24:03:DEBUG:CanonicalRequest:
PUT
/what_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T192403Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 15:24:03:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T192403Z
20230701/us-east-1/s3/aws4_request
2d4124ff4d15c0f545d0f56ee49d3323de303715df52232ea9d5ce348c5db25a
2023-07-01 15:24:03:DEBUG:Signature:
8ced471a2ac8b650fce4a74a0b35e21f61fe450b524d6b47e65b7afade85b572
2023-07-01 15:24:03:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x105ffd700>
2023-07-01 15:24:03:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T192403Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=df/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=8ced471a2ac8b650fce4a74a0b35e21f61fe450b524d6b47e65b7afade85b572', 'amz-sdk-invocation-id': b'da49eb4a-e4c0-4653-930d-e95513eac94e', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 15:24:03:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 15:24:03:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 15:24:03:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_this HTTP/1.1" 403 None
2023-07-01 15:24:03:DEBUG:Response headers: {'x-amz-request-id': 'NXHCS6PY04Q0M56B', 'x-amz-id-2': '0kvbv58q93i/xPncQ2XOmQFAYnWqDqjMQe6ewhEoFE2bn5XGoN9EflgmbXMO+mbQwWvhyJd1CIc=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 19:24:02 GMT', 'Server': 'AmazonS3'}
2023-07-01 15:24:03:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidAccessKeyId</Code><Message>The AWS Access Key Id you provided does not exist in our records.</Message><AWSAccessKeyId>df</AWSAccessKeyId><RequestId>NXHCS6PY04Q0M56B</RequestId><HostId>0kvbv58q93i/xPncQ2XOmQFAYnWqDqjMQe6ewhEoFE2bn5XGoN9EflgmbXMO+mbQwWvhyJd1CIc=</HostId></Error>'
2023-07-01 15:24:03:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x1260f0700>
2023-07-01 15:24:03:DEBUG:No retry needed.
2023-07-01 15:24:03:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x1260f0760>>
2023-07-01 15:25:03:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:25:03:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:25:40:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:25:40:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:44:16:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:44:16:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:45:14:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:45:14:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:45:14:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:45:14:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:45:14:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 15:45:14:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 15:45:14:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 15:45:14:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 15:45:14:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 15:45:14:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 15:45:14:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 15:45:14:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 15:45:14:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 15:45:14:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 15:45:14:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 15:45:14:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 15:45:14:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 15:45:14:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x101eee280>
2023-07-01 15:45:14:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 15:45:14:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 15:45:14:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 15:45:14:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x101e2f280>
2023-07-01 15:45:14:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x12a74aca0>
2023-07-01 15:45:14:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x101e2f040>
2023-07-01 15:45:14:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 15:45:14:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 15:45:14:DEBUG:Registering retry handlers for service: s3
2023-07-01 15:45:14:DEBUG:Registering S3 region redirector handler
2023-07-01 15:45:14:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x101f35940>
2023-07-01 15:45:14:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x12b1cea00>>
2023-07-01 15:45:14:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 15:45:14:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_this
2023-07-01 15:45:14:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 15:45:14:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 15:45:14:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x101f2d940>
2023-07-01 15:45:14:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x101f35790>
2023-07-01 15:45:14:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x12b1cea00>>
2023-07-01 15:45:14:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x101f2d790>
2023-07-01 15:45:14:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x101f2dca0>
2023-07-01 15:45:14:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x101f2d430>
2023-07-01 15:45:14:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x101f35040>
2023-07-01 15:45:14:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_this/', 'url': 'https://s3.amazonaws.com/what_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x12b021280>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_this', 'params': {'Bucket': 'what_is_this'}}}}
2023-07-01 15:45:14:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x12b0212b0>>
2023-07-01 15:45:14:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x12a744ac0>>
2023-07-01 15:45:14:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x101f2d670>
2023-07-01 15:45:14:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x101f358b0>
2023-07-01 15:45:14:DEBUG:Calculating signature using v4 auth.
2023-07-01 15:45:14:DEBUG:CanonicalRequest:
PUT
/what_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T194514Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 15:45:14:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T194514Z
20230701/us-east-1/s3/aws4_request
bcaa12272240dfab813d06fca7dca3f61311692bdf1f8144972c8820d99678fa
2023-07-01 15:45:14:DEBUG:Signature:
0126a005d93dc43da0b403abc5c820ab8fa3f84db76813e4c871594eb59713c3
2023-07-01 15:45:14:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x101f35700>
2023-07-01 15:45:14:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T194514Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=0126a005d93dc43da0b403abc5c820ab8fa3f84db76813e4c871594eb59713c3', 'amz-sdk-invocation-id': b'6e13a6ea-3784-42d1-9492-547b6b236036', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 15:45:14:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 15:45:14:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 15:45:15:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_this HTTP/1.1" 400 None
2023-07-01 15:45:15:DEBUG:Response headers: {'x-amz-request-id': '5WHDZDVM0JKA5P9Q', 'x-amz-id-2': 'jLH7opPd5PsN76gAuKpV0tjzn3zejnoEaJmRauXZzEn+ZNgnYm2JVt+T2mHTQPqSDfCss8qpk8c=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 19:45:14 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2023-07-01 15:45:15:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidBucketName</Code><Message>The specified bucket is not valid.</Message><BucketName>what_is_this</BucketName><RequestId>5WHDZDVM0JKA5P9Q</RequestId><HostId>jLH7opPd5PsN76gAuKpV0tjzn3zejnoEaJmRauXZzEn+ZNgnYm2JVt+T2mHTQPqSDfCss8qpk8c=</HostId></Error>'
2023-07-01 15:45:15:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x12b1ce9a0>
2023-07-01 15:45:15:DEBUG:No retry needed.
2023-07-01 15:45:15:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x12b1cea00>>
2023-07-01 15:45:42:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 15:45:42:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:45:42:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:45:42:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 15:45:53:INFO::get_mysql_connections::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 15:45:53:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:45:53:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:45:53:INFO::get_mysql_connections::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 15:55:15:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:55:15:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:55:15:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:55:15:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:55:15:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 15:55:15:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 15:55:15:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 15:55:15:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 15:55:15:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 15:55:15:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 15:55:15:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 15:55:15:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 15:55:15:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 15:55:15:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 15:55:15:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 15:55:15:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 15:55:15:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 15:55:15:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x103afe280>
2023-07-01 15:55:15:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 15:55:15:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 15:55:15:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 15:55:15:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x103a3f280>
2023-07-01 15:55:15:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x12f4eaca0>
2023-07-01 15:55:15:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x103a3f040>
2023-07-01 15:55:15:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 15:55:15:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 15:55:15:DEBUG:Registering retry handlers for service: s3
2023-07-01 15:55:15:DEBUG:Registering S3 region redirector handler
2023-07-01 15:55:15:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x103b45940>
2023-07-01 15:55:15:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x12ff6ea00>>
2023-07-01 15:55:15:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is_is_this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 15:55:15:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is_is_this
2023-07-01 15:55:15:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 15:55:15:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 15:55:15:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x103b3d940>
2023-07-01 15:55:15:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x103b45790>
2023-07-01 15:55:15:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x12ff6ea00>>
2023-07-01 15:55:15:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x103b3d790>
2023-07-01 15:55:15:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x103b3dca0>
2023-07-01 15:55:15:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x103b3d430>
2023-07-01 15:55:15:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x103b45040>
2023-07-01 15:55:15:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is_is_this/', 'url': 'https://s3.amazonaws.com/what_is_is_this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x12fdc1280>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is_is_this', 'params': {'Bucket': 'what_is_is_this'}}}}
2023-07-01 15:55:15:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x12fdc12b0>>
2023-07-01 15:55:15:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x12f4e4ac0>>
2023-07-01 15:55:15:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x103b3d670>
2023-07-01 15:55:15:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x103b458b0>
2023-07-01 15:55:15:DEBUG:Calculating signature using v4 auth.
2023-07-01 15:55:15:DEBUG:CanonicalRequest:
PUT
/what_is_is_this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T195515Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 15:55:15:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T195515Z
20230701/us-east-1/s3/aws4_request
8dfb799f40d9e8daa399fb5ded6d8e27e7fa2ee9062cf1c2aa374d1e5da24a6e
2023-07-01 15:55:15:DEBUG:Signature:
7947d7200679fd843f340ca0cc9a6c5960a479a0de1ac458d48f46337ffec62f
2023-07-01 15:55:15:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x103b45700>
2023-07-01 15:55:15:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is_is_this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T195515Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=7947d7200679fd843f340ca0cc9a6c5960a479a0de1ac458d48f46337ffec62f', 'amz-sdk-invocation-id': b'326caccc-d7ae-46c1-9e8c-17fc49a8f420', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 15:55:15:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 15:55:15:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 15:55:16:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is_is_this HTTP/1.1" 400 None
2023-07-01 15:55:16:DEBUG:Response headers: {'x-amz-request-id': 'D1728R7BK3YB00VJ', 'x-amz-id-2': '0/0GgQ2Z0+32yrhPT6ZPaDlygRSpeuMAe/y3ZVl/paR7GY9T5XU59nK8oaSAuPZ2itioNZFkVUA=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 19:55:15 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2023-07-01 15:55:16:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidBucketName</Code><Message>The specified bucket is not valid.</Message><BucketName>what_is_is_this</BucketName><RequestId>D1728R7BK3YB00VJ</RequestId><HostId>0/0GgQ2Z0+32yrhPT6ZPaDlygRSpeuMAe/y3ZVl/paR7GY9T5XU59nK8oaSAuPZ2itioNZFkVUA=</HostId></Error>'
2023-07-01 15:55:16:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x12ff6e9a0>
2023-07-01 15:55:16:DEBUG:No retry needed.
2023-07-01 15:55:16:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x12ff6ea00>>
2023-07-01 15:55:28:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:55:28:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:55:28:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:55:28:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:55:28:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 15:55:28:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 15:55:28:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 15:55:28:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 15:55:28:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 15:55:28:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 15:55:28:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 15:55:28:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 15:55:28:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 15:55:28:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 15:55:28:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 15:55:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 15:55:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 15:55:28:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x107136280>
2023-07-01 15:55:28:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 15:55:29:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 15:55:29:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 15:55:29:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x105f5e280>
2023-07-01 15:55:29:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x10fd2aca0>
2023-07-01 15:55:29:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x105f5e040>
2023-07-01 15:55:29:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 15:55:29:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 15:55:29:DEBUG:Registering retry handlers for service: s3
2023-07-01 15:55:29:DEBUG:Registering S3 region redirector handler
2023-07-01 15:55:29:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x107169940>
2023-07-01 15:55:29:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x11f0aea00>>
2023-07-01 15:55:29:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what-is-is-this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 15:55:29:DEBUG:Endpoint provider result: https://what-is-is-this.s3.amazonaws.com
2023-07-01 15:55:29:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 15:55:29:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 15:55:29:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0x107161940>
2023-07-01 15:55:29:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0x107169790>
2023-07-01 15:55:29:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x11f0aea00>>
2023-07-01 15:55:29:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0x107161790>
2023-07-01 15:55:29:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0x107161ca0>
2023-07-01 15:55:29:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0x107161430>
2023-07-01 15:55:29:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0x107169040>
2023-07-01 15:55:29:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what-is-is-this/', 'url': 'https://what-is-is-this.s3.amazonaws.com/', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x11c701280>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what-is-is-this', 'params': {'Bucket': 'what-is-is-this'}}}}
2023-07-01 15:55:29:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x11c7012b0>>
2023-07-01 15:55:29:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x10fd24ac0>>
2023-07-01 15:55:29:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0x107161670>
2023-07-01 15:55:29:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0x1071698b0>
2023-07-01 15:55:29:DEBUG:Calculating signature using v4 auth.
2023-07-01 15:55:29:DEBUG:CanonicalRequest:
PUT
/

host:what-is-is-this.s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T195529Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 15:55:29:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T195529Z
20230701/us-east-1/s3/aws4_request
318be6029a2845913f10fa76eb2295fa7fe3174ad3108d4ba626450f7fbc2a6f
2023-07-01 15:55:29:DEBUG:Signature:
911fa07b531a7b0a1add5bf167fe2858fb9a40d74b2dca72fcc77dd65901af6c
2023-07-01 15:55:29:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0x107169700>
2023-07-01 15:55:29:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://what-is-is-this.s3.amazonaws.com/, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'X-Amz-Date': b'20230701T195529Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=911fa07b531a7b0a1add5bf167fe2858fb9a40d74b2dca72fcc77dd65901af6c', 'amz-sdk-invocation-id': b'b6215545-df79-43fa-a872-4bc15a8446a5', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 15:55:29:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 15:55:29:DEBUG:Starting new HTTPS connection (1): what-is-is-this.s3.amazonaws.com:443
2023-07-01 15:55:29:DEBUG:https://what-is-is-this.s3.amazonaws.com:443 "PUT / HTTP/1.1" 200 0
2023-07-01 15:55:29:DEBUG:Response headers: {'x-amz-id-2': '2TgGSePMyid1G/VvwIjTkZsoDNqXRQq/P113eLV2JA1MznaOuZ+eLYAZDxpWwgL/EcHQL0I6fQM=', 'x-amz-request-id': 'SBFGKW2TPXVBJ4B5', 'Date': 'Sat, 01 Jul 2023 19:55:30 GMT', 'Location': '/what-is-is-this', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 15:55:29:DEBUG:Response body:
b''
2023-07-01 15:55:29:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0x11f0ae9a0>
2023-07-01 15:55:29:DEBUG:No retry needed.
2023-07-01 15:55:29:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x11f0aea00>>
2023-07-01 15:56:34:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 15:56:34:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:56:34:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:56:34:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 15:56:34:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 15:56:34:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 15:56:34:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:56:34:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:56:34:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 15:56:34:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 15:56:34:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 15:56:34:DEBUG::fetch_weather_reports::message::'NoneType' object has no attribute 'empty'
2023-07-01 15:58:03:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 15:58:03:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 15:58:03:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 15:58:03:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 15:58:31:DEBUG:Starting new HTTPS connection (1): weatherapi-com.p.rapidapi.com:443
2023-07-01 15:58:31:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=10314 HTTP/1.1" 200 None
2023-07-01 19:59:29:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 19:59:29:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:59:29:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:59:29:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 19:59:29:DEBUG:Starting new HTTPS connection (1): weatherapi-com.p.rapidapi.com:443
2023-07-01 19:59:30:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=10314 HTTP/1.1" 200 None
2023-07-01 19:59:43:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:59:43:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:59:43:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:59:43:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:59:43:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 19:59:43:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 19:59:43:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 19:59:43:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 19:59:43:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 19:59:43:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 19:59:43:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 19:59:43:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 19:59:43:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 19:59:43:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 19:59:43:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 19:59:43:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 19:59:43:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 19:59:43:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffffbbf6b670>
2023-07-01 19:59:43:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 19:59:43:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 19:59:43:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 19:59:43:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffffbbfc33a0>
2023-07-01 19:59:43:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffffaa372700>
2023-07-01 19:59:43:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffffbbfc3160>
2023-07-01 19:59:43:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 19:59:43:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 19:59:43:DEBUG:Registering retry handlers for service: s3
2023-07-01 19:59:43:DEBUG:Registering S3 region redirector handler
2023-07-01 19:59:43:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffffbbef4d30>
2023-07-01 19:59:43:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffffa99e21c0>>
2023-07-01 19:59:43:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what_is-is-this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 19:59:43:DEBUG:Endpoint provider result: https://s3.amazonaws.com/what_is-is-this
2023-07-01 19:59:43:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 19:59:43:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 19:59:43:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0xffffbbeead30>
2023-07-01 19:59:43:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0xffffbbef4b80>
2023-07-01 19:59:43:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffffa99e21c0>>
2023-07-01 19:59:43:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0xffffbbeeab80>
2023-07-01 19:59:43:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0xffffbbef30d0>
2023-07-01 19:59:44:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0xffffbbeea820>
2023-07-01 19:59:44:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0xffffbbef4430>
2023-07-01 19:59:44:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what_is-is-this/', 'url': 'https://s3.amazonaws.com/what_is-is-this', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffffa9b1c370>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what_is-is-this', 'params': {'Bucket': 'what_is-is-this'}}}}
2023-07-01 19:59:44:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffffa9b1c3a0>>
2023-07-01 19:59:44:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffffaa363c40>>
2023-07-01 19:59:44:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffffbbeeaa60>
2023-07-01 19:59:44:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffffbbef4ca0>
2023-07-01 19:59:44:DEBUG:Calculating signature using v4 auth.
2023-07-01 19:59:44:DEBUG:CanonicalRequest:
PUT
/what_is-is-this

host:s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T195944Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 19:59:44:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T195944Z
20230701/us-east-1/s3/aws4_request
352df6bcab1a93dbb0ee8dae8203e4357ec961c5c116856b72ffe0b43b9918ee
2023-07-01 19:59:44:DEBUG:Signature:
01a4ffaa1a45796e2c9eb9b9ece528e7d7dda7760fb64ed590a7ab87fb94241e
2023-07-01 19:59:44:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffffbbef4af0>
2023-07-01 19:59:44:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://s3.amazonaws.com/what_is-is-this, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'X-Amz-Date': b'20230701T195944Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=01a4ffaa1a45796e2c9eb9b9ece528e7d7dda7760fb64ed590a7ab87fb94241e', 'amz-sdk-invocation-id': b'9a621fc0-3443-499a-96b5-45d49fe7b595', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 19:59:44:DEBUG:Certificate path: /usr/local/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 19:59:44:DEBUG:Starting new HTTPS connection (1): s3.amazonaws.com:443
2023-07-01 19:59:44:DEBUG:https://s3.amazonaws.com:443 "PUT /what_is-is-this HTTP/1.1" 400 None
2023-07-01 19:59:44:DEBUG:Response headers: {'x-amz-request-id': 'BR1366XZP3V964EX', 'x-amz-id-2': 'D72sOfK6LdDBQiSKdGtG3DQXLVLaeKhnfdV8xwvdrt55vOY8Jinhcn0mTIp8PEFf1OjoUa0TOQA=', 'Content-Type': 'application/xml', 'Transfer-Encoding': 'chunked', 'Date': 'Sat, 01 Jul 2023 19:59:44 GMT', 'Server': 'AmazonS3', 'Connection': 'close'}
2023-07-01 19:59:44:DEBUG:Response body:
b'<?xml version="1.0" encoding="UTF-8"?>\n<Error><Code>InvalidBucketName</Code><Message>The specified bucket is not valid.</Message><BucketName>what_is-is-this</BucketName><RequestId>BR1366XZP3V964EX</RequestId><HostId>D72sOfK6LdDBQiSKdGtG3DQXLVLaeKhnfdV8xwvdrt55vOY8Jinhcn0mTIp8PEFf1OjoUa0TOQA=</HostId></Error>'
2023-07-01 19:59:44:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffffa99e2160>
2023-07-01 19:59:44:DEBUG:No retry needed.
2023-07-01 19:59:44:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffffa99e21c0>>
2023-07-01 19:59:56:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:59:56:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:59:56:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:59:56:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:59:56:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 19:59:56:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 19:59:56:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 19:59:56:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 19:59:56:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 19:59:56:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 19:59:56:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 19:59:56:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 19:59:56:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 19:59:56:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 19:59:56:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 19:59:56:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 19:59:56:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 19:59:56:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffffa420f670>
2023-07-01 19:59:56:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 19:59:56:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 19:59:56:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 19:59:56:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffffa42673a0>
2023-07-01 19:59:56:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffff92616700>
2023-07-01 19:59:56:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffffa4267160>
2023-07-01 19:59:56:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 19:59:56:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 19:59:56:DEBUG:Registering retry handlers for service: s3
2023-07-01 19:59:56:DEBUG:Registering S3 region redirector handler
2023-07-01 19:59:56:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffffa4198d30>
2023-07-01 19:59:56:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff91c841c0>>
2023-07-01 19:59:56:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what-is-is-this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 19:59:56:DEBUG:Endpoint provider result: https://what-is-is-this.s3.amazonaws.com
2023-07-01 19:59:56:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 19:59:56:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 19:59:56:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0xffffa418ed30>
2023-07-01 19:59:56:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0xffffa4198b80>
2023-07-01 19:59:56:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff91c841c0>>
2023-07-01 19:59:56:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0xffffa418eb80>
2023-07-01 19:59:56:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0xffffa41970d0>
2023-07-01 19:59:56:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0xffffa418e820>
2023-07-01 19:59:56:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0xffffa4198430>
2023-07-01 19:59:56:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what-is-is-this/', 'url': 'https://what-is-is-this.s3.amazonaws.com/', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff91dc0370>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what-is-is-this', 'params': {'Bucket': 'what-is-is-this'}}}}
2023-07-01 19:59:56:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff91dc03a0>>
2023-07-01 19:59:56:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffff92607c40>>
2023-07-01 19:59:56:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffffa418ea60>
2023-07-01 19:59:56:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffffa4198ca0>
2023-07-01 19:59:56:DEBUG:Calculating signature using v4 auth.
2023-07-01 19:59:56:DEBUG:CanonicalRequest:
PUT
/

host:what-is-is-this.s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T195956Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 19:59:56:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T195956Z
20230701/us-east-1/s3/aws4_request
e595b518b95fd2e0679862f44c6bd6c251443800019073c65afd584f16e0fe33
2023-07-01 19:59:56:DEBUG:Signature:
4ae0135ddd3f109defe82cf886e9ab6aa57f10183bbd1a13140e2c1409c1fac3
2023-07-01 19:59:56:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffffa4198af0>
2023-07-01 19:59:56:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://what-is-is-this.s3.amazonaws.com/, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'X-Amz-Date': b'20230701T195956Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=4ae0135ddd3f109defe82cf886e9ab6aa57f10183bbd1a13140e2c1409c1fac3', 'amz-sdk-invocation-id': b'969c273e-19b2-4be2-8f23-1044c8950f95', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 19:59:56:DEBUG:Certificate path: /usr/local/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 19:59:56:DEBUG:Starting new HTTPS connection (1): what-is-is-this.s3.amazonaws.com:443
2023-07-01 19:59:56:DEBUG:https://what-is-is-this.s3.amazonaws.com:443 "PUT / HTTP/1.1" 200 0
2023-07-01 19:59:56:DEBUG:Response headers: {'x-amz-id-2': 'XoGsjdAaf374VsBAFSwfPZcMcF42EsKGAUJOYeyePnGDVVzHxzA6RBbGccXkUCGLL6LwQFyBBc4=', 'x-amz-request-id': '1J87MWMSTYH0Z81Z', 'Date': 'Sat, 01 Jul 2023 19:59:57 GMT', 'Location': '/what-is-is-this', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 19:59:56:DEBUG:Response body:
b''
2023-07-01 19:59:56:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffff91c84160>
2023-07-01 19:59:56:DEBUG:No retry needed.
2023-07-01 19:59:56:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff91c841c0>>
2023-07-01 20:00:02:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 20:00:02:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 20:00:02:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 20:00:02:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 20:00:02:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 20:00:02:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 20:00:02:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 20:00:02:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 20:00:02:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 20:00:02:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 20:00:02:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 20:00:02:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 20:00:02:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 20:00:02:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 20:00:02:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 20:00:02:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 20:00:02:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 20:00:02:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffff97cb9670>
2023-07-01 20:00:02:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 20:00:02:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 20:00:02:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 20:00:02:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffff97d113a0>
2023-07-01 20:00:02:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffff860c0700>
2023-07-01 20:00:02:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffff97d11160>
2023-07-01 20:00:02:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 20:00:02:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 20:00:02:DEBUG:Registering retry handlers for service: s3
2023-07-01 20:00:02:DEBUG:Registering S3 region redirector handler
2023-07-01 20:00:02:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffff97c42d30>
2023-07-01 20:00:02:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff8572e1c0>>
2023-07-01 20:00:02:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'what-is-is-this', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableAccessPoints': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 20:00:02:DEBUG:Endpoint provider result: https://what-is-is-this.s3.amazonaws.com
2023-07-01 20:00:02:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 20:00:02:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 20:00:02:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function validate_bucket_name at 0xffff97c38d30>
2023-07-01 20:00:02:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function remove_bucket_from_url_paths_from_model at 0xffff97c42b80>
2023-07-01 20:00:02:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff8572e1c0>>
2023-07-01 20:00:02:DEBUG:Event before-parameter-build.s3.CreateBucket: calling handler <function generate_idempotent_uuid at 0xffff97c38b80>
2023-07-01 20:00:02:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_expect_header at 0xffff97c410d0>
2023-07-01 20:00:02:DEBUG:Event before-call.s3.CreateBucket: calling handler <function add_recursion_detection_header at 0xffff97c38820>
2023-07-01 20:00:02:DEBUG:Event before-call.s3.CreateBucket: calling handler <function inject_api_version_header_if_needed at 0xffff97c42430>
2023-07-01 20:00:02:DEBUG:Making request for OperationModel(name=CreateBucket) with params: {'url_path': '', 'query_string': {}, 'method': 'PUT', 'headers': {'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125'}, 'body': b'', 'auth_path': '/what-is-is-this/', 'url': 'https://what-is-is-this.s3.amazonaws.com/', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff8586a370>, 'has_streaming_input': False, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'what-is-is-this', 'params': {'Bucket': 'what-is-is-this'}}}}
2023-07-01 20:00:02:DEBUG:Event request-created.s3.CreateBucket: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff8586a3a0>>
2023-07-01 20:00:02:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffff860b1c40>>
2023-07-01 20:00:02:DEBUG:Event choose-signer.s3.CreateBucket: calling handler <function set_operation_specific_signer at 0xffff97c38a60>
2023-07-01 20:00:02:DEBUG:Event before-sign.s3.CreateBucket: calling handler <function remove_arn_from_signing_path at 0xffff97c42ca0>
2023-07-01 20:00:02:DEBUG:Calculating signature using v4 auth.
2023-07-01 20:00:02:DEBUG:CanonicalRequest:
PUT
/

host:what-is-is-this.s3.amazonaws.com
x-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
x-amz-date:20230701T200002Z

host;x-amz-content-sha256;x-amz-date
e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855
2023-07-01 20:00:02:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T200002Z
20230701/us-east-1/s3/aws4_request
d0ca9f63daaddd8d8e5b8978789d15f30578490fb656e1af0b5a65f00f3f7a67
2023-07-01 20:00:02:DEBUG:Signature:
2320985bdaef569c5f814ec86a8905212887cd9d2a4c2e0c9aa4030123154cb6
2023-07-01 20:00:02:DEBUG:Event request-created.s3.CreateBucket: calling handler <function add_retry_headers at 0xffff97c42af0>
2023-07-01 20:00:02:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://what-is-is-this.s3.amazonaws.com/, headers={'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'X-Amz-Date': b'20230701T200002Z', 'X-Amz-Content-SHA256': b'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=host;x-amz-content-sha256;x-amz-date, Signature=2320985bdaef569c5f814ec86a8905212887cd9d2a4c2e0c9aa4030123154cb6', 'amz-sdk-invocation-id': b'7e80cbeb-a2f7-4cd9-af0d-f2badcd068c7', 'amz-sdk-request': b'attempt=1', 'Content-Length': '0'}>
2023-07-01 20:00:02:DEBUG:Certificate path: /usr/local/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 20:00:02:DEBUG:Starting new HTTPS connection (1): what-is-is-this.s3.amazonaws.com:443
2023-07-01 20:00:02:DEBUG:https://what-is-is-this.s3.amazonaws.com:443 "PUT / HTTP/1.1" 200 0
2023-07-01 20:00:02:DEBUG:Response headers: {'x-amz-id-2': 'gRE27avDm9TVSoTiDMoffvRvaYKCspulrW02l93gA3XG6rQXQGuwUhvrcLKFNWVN58FDS/J2Cs4=', 'x-amz-request-id': 'YMJ89S74MG0K8W3A', 'Date': 'Sat, 01 Jul 2023 20:00:03 GMT', 'Location': '/what-is-is-this', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 20:00:02:DEBUG:Response body:
b''
2023-07-01 20:00:02:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <botocore.retryhandler.RetryHandler object at 0xffff8572e160>
2023-07-01 20:00:02:DEBUG:No retry needed.
2023-07-01 20:00:02:DEBUG:Event needs-retry.s3.CreateBucket: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff8572e1c0>>
2023-07-01 17:41:04:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:41:04:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:41:04:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:41:04:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:41:04:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:41:04:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 17:41:04:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 17:41:04:DEBUG::fetch_weather_reports::message::name 'get_weather_api_session' is not defined
2023-07-01 17:41:43:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:41:43:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:41:43:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:41:43:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:41:43:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:41:43:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 17:41:43:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 17:41:43:DEBUG::fetch_weather_reports::message::name 'get_weather_api_session' is not defined
2023-07-01 17:42:23:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:42:23:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:42:23:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:42:23:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:42:23:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:42:23:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 17:42:23:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 17:42:23:DEBUG::fetch_weather_reports::message::name 'get_weather_api_session' is not defined
2023-07-01 17:42:24:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:42:24:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:42:24:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:42:24:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:42:24:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 17:42:24:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 17:42:24:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 17:42:24:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 17:42:24:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 17:42:24:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 17:42:24:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 17:42:24:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 17:42:24:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 17:42:24:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 17:42:24:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 17:42:24:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 17:42:24:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 17:42:24:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x103e5f4c0>
2023-07-01 17:42:24:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 17:42:24:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 17:42:24:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 17:42:24:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x103da34c0>
2023-07-01 17:42:24:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x105759c10>
2023-07-01 17:42:24:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x103da3280>
2023-07-01 17:42:24:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 17:42:24:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 17:42:24:DEBUG:Registering retry handlers for service: s3
2023-07-01 17:42:24:DEBUG:Registering S3 region redirector handler
2023-07-01 17:42:24:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x103ea7b80>
2023-07-01 17:42:24:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x12198ad30>>
2023-07-01 17:42:24:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'staging-data-ab', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 17:42:24:DEBUG:Endpoint provider result: https://staging-data-ab.s3.amazonaws.com
2023-07-01 17:42:24:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 17:42:24:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x103ea4820>
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x103ea1c10>
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x103ea7160>
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x103ea1b80>
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x103ea79d0>
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x12198ad30>>
2023-07-01 17:42:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x103ea19d0>
2023-07-01 17:42:24:DEBUG:Event before-call.s3.PutObject: calling handler <function conditionally_calculate_md5 at 0x103c48f70>
2023-07-01 17:42:24:DEBUG:Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x103ea1ee0>
2023-07-01 17:42:24:DEBUG:Adding expect 100 continue header to request.
2023-07-01 17:42:24:DEBUG:Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x103ea1670>
2023-07-01 17:42:24:DEBUG:Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x103ea7280>
2023-07-01 17:42:24:DEBUG:Making request for OperationModel(name=PutObject) with params: {'url_path': '/weather-reports/2023-07-01/05-PM', 'query_string': {}, 'method': 'PUT', 'headers': {'x-amz-acl': 'private', 'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'Content-MD5': 'N6YlnMDB2uKZp4Zkid/wvQ==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0x121837ae0>, 'auth_path': '/staging-data-ab/weather-reports/2023-07-01/05-PM', 'url': 'https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/05-PM', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x12183c5e0>, 'has_streaming_input': True, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'staging-data-ab', 'params': {'Bucket': 'staging-data-ab', 'Key': 'weather-reports/2023-07-01/05-PM', 'Body': <_io.BytesIO object at 0x121837ae0>, 'ACL': 'private'}}}}
2023-07-01 17:42:24:DEBUG:Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x12183c610>>
2023-07-01 17:42:24:DEBUG:Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x1207ef1c0>>
2023-07-01 17:42:24:DEBUG:Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x103ea18b0>
2023-07-01 17:42:24:DEBUG:Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x103ea7af0>
2023-07-01 17:42:24:DEBUG:Calculating signature using v4 auth.
2023-07-01 17:42:24:DEBUG:CanonicalRequest:
PUT
/weather-reports/2023-07-01/05-PM

content-md5:N6YlnMDB2uKZp4Zkid/wvQ==
host:staging-data-ab.s3.amazonaws.com
x-amz-acl:private
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20230701T214224Z

content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2023-07-01 17:42:24:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T214224Z
20230701/us-east-1/s3/aws4_request
74098768e426e0e20b9e4f98e961722de678077cfdc16fcfd4ecb1c1d5b9c325
2023-07-01 17:42:24:DEBUG:Signature:
6937a0cb5fd717af89910fb501aef7c5d5853567ad39e0e16465f2945f74af6b
2023-07-01 17:42:24:DEBUG:Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x103ea7940>
2023-07-01 17:42:24:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/05-PM, headers={'x-amz-acl': b'private', 'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'Content-MD5': b'N6YlnMDB2uKZp4Zkid/wvQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20230701T214224Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date, Signature=6937a0cb5fd717af89910fb501aef7c5d5853567ad39e0e16465f2945f74af6b', 'amz-sdk-invocation-id': b'f9e392c6-b648-45c3-ae26-6e855ce547ff', 'amz-sdk-request': b'attempt=1', 'Content-Length': '4'}>
2023-07-01 17:42:24:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 17:42:24:DEBUG:Starting new HTTPS connection (1): staging-data-ab.s3.amazonaws.com:443
2023-07-01 17:42:24:DEBUG:Waiting for 100 Continue response.
2023-07-01 17:42:24:DEBUG:100 Continue response seen, now sending request body.
2023-07-01 17:42:24:DEBUG:https://staging-data-ab.s3.amazonaws.com:443 "PUT /weather-reports/2023-07-01/05-PM HTTP/1.1" 200 0
2023-07-01 17:42:24:DEBUG:Response headers: {'x-amz-id-2': 'UJ6vxmcVU+WtviONuNiq+5GlkEsafMHBDS1pb4KXfBmsBFG+wzONaFNpJaciqBKFZNJj0w2gzCR0LDZYpdqCfw==', 'x-amz-request-id': '4BH6X5SPNJ0RAJT3', 'Date': 'Sat, 01 Jul 2023 21:42:25 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"37a6259cc0c1dae299a7866489dff0bd"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 17:42:24:DEBUG:Response body:
b''
2023-07-01 17:42:24:DEBUG:Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x12198acd0>
2023-07-01 17:42:24:DEBUG:No retry needed.
2023-07-01 17:42:24:DEBUG:Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x12198ad30>>
2023-07-01 17:50:02:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:50:02:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:50:02:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:50:02:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:50:02:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:50:02:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 17:50:42:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 17:50:42:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 17:50:42:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 17:50:42:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 17:50:42:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 17:50:42:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 17:50:42:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 17:50:42:DEBUG::fetch_weather_reports::message::name 'get_weather_api_session' is not defined
2023-07-01 18:08:19:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 18:08:19:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 18:08:19:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:08:19:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:08:19:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 18:08:19:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 18:08:19:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:08:19:DEBUG::fetch_weather_reports::message::name 'get_weather_api_session' is not defined
2023-07-01 18:08:26:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 18:08:26:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 18:08:26:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:08:26:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:08:26:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 18:08:26:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 18:08:26:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:08:26:DEBUG::fetch_weather_reports::message::name 'get_weather_api_session' is not defined
2023-07-01 18:08:26:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:08:26:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:08:26:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:08:26:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:08:26:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 18:08:26:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 18:08:26:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 18:08:26:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 18:08:26:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 18:08:26:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 18:08:26:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 18:08:26:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 18:08:26:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 18:08:26:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 18:08:26:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 18:08:26:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 18:08:26:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 18:08:26:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x1057ef4c0>
2023-07-01 18:08:26:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 18:08:26:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 18:08:26:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 18:08:26:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x1057334c0>
2023-07-01 18:08:26:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x107d05c10>
2023-07-01 18:08:26:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x105733280>
2023-07-01 18:08:26:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 18:08:26:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 18:08:26:DEBUG:Registering retry handlers for service: s3
2023-07-01 18:08:26:DEBUG:Registering S3 region redirector handler
2023-07-01 18:08:26:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0x105837b80>
2023-07-01 18:08:26:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0x127a09d30>>
2023-07-01 18:08:26:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'staging-data-ab', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 18:08:26:DEBUG:Endpoint provider result: https://staging-data-ab.s3.amazonaws.com
2023-07-01 18:08:26:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 18:08:26:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0x105834820>
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0x105831c10>
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0x105837160>
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0x105831b80>
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0x1058379d0>
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0x127a09d30>>
2023-07-01 18:08:26:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0x1058319d0>
2023-07-01 18:08:26:DEBUG:Event before-call.s3.PutObject: calling handler <function conditionally_calculate_md5 at 0x1055d8f70>
2023-07-01 18:08:26:DEBUG:Event before-call.s3.PutObject: calling handler <function add_expect_header at 0x105831ee0>
2023-07-01 18:08:26:DEBUG:Adding expect 100 continue header to request.
2023-07-01 18:08:26:DEBUG:Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0x105831670>
2023-07-01 18:08:26:DEBUG:Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0x105837280>
2023-07-01 18:08:26:DEBUG:Making request for OperationModel(name=PutObject) with params: {'url_path': '/weather-reports/2023-07-01/06-PM', 'query_string': {}, 'method': 'PUT', 'headers': {'x-amz-acl': 'private', 'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'Content-MD5': 'N6YlnMDB2uKZp4Zkid/wvQ==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0x1278b6cc0>, 'auth_path': '/staging-data-ab/weather-reports/2023-07-01/06-PM', 'url': 'https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/06-PM', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0x1278bc5e0>, 'has_streaming_input': True, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'staging-data-ab', 'params': {'Bucket': 'staging-data-ab', 'Key': 'weather-reports/2023-07-01/06-PM', 'Body': <_io.BytesIO object at 0x1278b6cc0>, 'ACL': 'private'}}}}
2023-07-01 18:08:26:DEBUG:Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0x1278bc610>>
2023-07-01 18:08:26:DEBUG:Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0x10469d880>>
2023-07-01 18:08:26:DEBUG:Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0x1058318b0>
2023-07-01 18:08:26:DEBUG:Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0x105837af0>
2023-07-01 18:08:26:DEBUG:Calculating signature using v4 auth.
2023-07-01 18:08:26:DEBUG:CanonicalRequest:
PUT
/weather-reports/2023-07-01/06-PM

content-md5:N6YlnMDB2uKZp4Zkid/wvQ==
host:staging-data-ab.s3.amazonaws.com
x-amz-acl:private
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20230701T220826Z

content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2023-07-01 18:08:26:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T220826Z
20230701/us-east-1/s3/aws4_request
bfb3870180ab8bd8480876133f893738ed95256dab7af2c30270df2869a5171d
2023-07-01 18:08:26:DEBUG:Signature:
9ce8fbf02d85dcde2bb77be0422c3f875eb965977c8eab63ae97bc23bc2d4041
2023-07-01 18:08:26:DEBUG:Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0x105837940>
2023-07-01 18:08:26:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/06-PM, headers={'x-amz-acl': b'private', 'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Darwin/21.4.0 Botocore/1.29.125', 'Content-MD5': b'N6YlnMDB2uKZp4Zkid/wvQ==', 'Expect': b'100-continue', 'X-Amz-Date': b'20230701T220826Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date, Signature=9ce8fbf02d85dcde2bb77be0422c3f875eb965977c8eab63ae97bc23bc2d4041', 'amz-sdk-invocation-id': b'364e4bab-455d-4cfe-9e97-c08cfb9129fb', 'amz-sdk-request': b'attempt=1', 'Content-Length': '4'}>
2023-07-01 18:08:26:DEBUG:Certificate path: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 18:08:26:DEBUG:Starting new HTTPS connection (1): staging-data-ab.s3.amazonaws.com:443
2023-07-01 18:08:27:DEBUG:Waiting for 100 Continue response.
2023-07-01 18:08:27:DEBUG:100 Continue response seen, now sending request body.
2023-07-01 18:08:27:DEBUG:https://staging-data-ab.s3.amazonaws.com:443 "PUT /weather-reports/2023-07-01/06-PM HTTP/1.1" 200 0
2023-07-01 18:08:27:DEBUG:Response headers: {'x-amz-id-2': 'CcuGVqajbnUvv/OkvJrCN/zNW/swrXMitPpYvhVUzJtUtPMiSaoME4wCmZzEjBOEPz92xNmz6gk=', 'x-amz-request-id': 'F8Y87GKHF8K9KHGF', 'Date': 'Sat, 01 Jul 2023 22:08:28 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"37a6259cc0c1dae299a7866489dff0bd"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 18:08:27:DEBUG:Response body:
b''
2023-07-01 18:08:27:DEBUG:Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0x127a09cd0>
2023-07-01 18:08:27:DEBUG:No retry needed.
2023-07-01 18:08:27:DEBUG:Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0x127a09d30>>
2023-07-01 18:23:38:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:23:38:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 18:23:38:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:23:38:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:23:38:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 18:23:38:DEBUG::fetch_weather_reports::message::'NoneType' object has no attribute 'empty'
2023-07-01 18:24:34:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:24:34:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 18:24:34:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:24:34:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:24:34:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 18:24:34:INFO::fetch_weather_reports::Completed with results <class 'NoneType'>.
2023-07-01 18:24:58:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:24:58:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 18:24:58:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:24:58:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:24:58:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 18:24:58:DEBUG::fetch_weather_reports::message::Attribute reference or assignment failed.
2023-07-01 18:25:37:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:25:37:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 18:25:37:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:25:37:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:25:37:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 18:25:37:DEBUG::fetch_weather_reports::message::Attribute reference or assignment failed.
2023-07-01 18:25:58:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 18:25:58:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 18:25:58:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:25:58:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:25:58:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 18:25:58:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 18:25:58:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 18:25:58:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 18:25:58:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 18:25:58:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 18:25:58:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 18:25:58:DEBUG::fetch_weather_reports::message::Attribute reference or assignment failed.
2023-07-01 19:09:53:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:09:53:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:09:53:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:09:53:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:09:53:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 19:09:53:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 19:09:53:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 19:09:53:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 19:09:53:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 19:09:53:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 19:09:53:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 19:09:53:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 19:09:53:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 19:09:53:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 19:09:53:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 19:09:53:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 19:09:53:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 19:09:53:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0x101fe80d0>
2023-07-01 19:09:53:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 19:09:53:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 19:09:53:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 19:09:53:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0x101f1ec10>
2023-07-01 19:09:53:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0x101a8e790>
2023-07-01 19:09:53:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0x101f1e9d0>
2023-07-01 19:09:53:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 19:09:53:DEBUG:Loading JSON file: /Users/alibashir/Desktop/workspace.nosync/ETL/weather_reports_ETL/venv/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 19:09:53:DEBUG:Registering retry handlers for service: s3
2023-07-01 19:09:53:DEBUG:Registering S3 region redirector handler
2023-07-01 19:32:17:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 19:32:17:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 19:32:17:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:32:17:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:32:17:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 19:32:18:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 19:33:05:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 19:33:05:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:33:05:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:33:05:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 19:33:05:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 19:33:05:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 19:33:05:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:33:05:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:33:05:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 19:33:05:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 19:33:05:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 19:33:05:DEBUG::fetch_weather_reports::message::fetch_weather_reports() takes 0 positional arguments but 2 were given
2023-07-01 19:33:40:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 19:33:40:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 19:33:40:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:33:40:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:33:40:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 19:33:40:DEBUG::fetch_most_populated_zipcodes::message::(psycopg2.OperationalError) connection to server at "weather_db_postgres" (192.168.1.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2023-07-01 19:33:40:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 19:33:40:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 19:33:40:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 19:33:40:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 19:33:40:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 19:33:40:DEBUG::fetch_weather_reports::message::Attribute reference or assignment failed.
2023-07-01 23:34:24:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 23:34:24:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 23:34:24:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:34:24:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:34:24:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 23:34:24:INFO::fetch_most_populated_zipcodes::Completed with results <class 'pandas.core.series.Series'>.
2023-07-01 23:35:23:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 23:35:23:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 23:35:23:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:35:23:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:35:23:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 23:35:23:INFO::fetch_most_populated_zipcodes::Completed with results <class 'pandas.core.series.Series'>.
2023-07-01 23:35:23:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 23:35:23:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 23:35:23:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:35:23:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:35:23:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 23:35:23:DEBUG:Starting new HTTPS connection (1): weatherapi-com.p.rapidapi.com:443
2023-07-01 23:35:23:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99661 HTTP/1.1" 200 None
2023-07-01 23:35:24:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99692 HTTP/1.1" 200 None
2023-07-01 23:35:24:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99504 HTTP/1.1" 200 None
2023-07-01 23:35:24:INFO::fetch_weather_reports::Completed with results <class 'list'>.
2023-07-01 23:35:24:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:35:24:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:35:24:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:35:24:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:35:24:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 23:35:24:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 23:35:24:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 23:35:24:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 23:35:24:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 23:35:24:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 23:35:24:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 23:35:24:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 23:35:24:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 23:35:24:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 23:35:24:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 23:35:24:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 23:35:24:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 23:35:24:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffff8442a700>
2023-07-01 23:35:24:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 23:35:24:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 23:35:24:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 23:35:24:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffff844894c0>
2023-07-01 23:35:24:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffff836691f0>
2023-07-01 23:35:24:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffff84489280>
2023-07-01 23:35:24:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 23:35:24:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 23:35:24:DEBUG:Registering retry handlers for service: s3
2023-07-01 23:35:24:DEBUG:Registering S3 region redirector handler
2023-07-01 23:35:24:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffff843c8dc0>
2023-07-01 23:35:24:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff82aaaac0>>
2023-07-01 23:35:24:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'staging-data-ab', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 23:35:24:DEBUG:Endpoint provider result: https://staging-data-ab.s3.amazonaws.com
2023-07-01 23:35:24:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 23:35:24:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0xffff843c7a60>
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0xffff843c4e50>
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0xffff843c83a0>
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0xffff843c4dc0>
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0xffff843c8c10>
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff82aaaac0>>
2023-07-01 23:35:24:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0xffff843c4c10>
2023-07-01 23:35:24:DEBUG:Event before-call.s3.PutObject: calling handler <function conditionally_calculate_md5 at 0xffff84550670>
2023-07-01 23:35:24:DEBUG:Event before-call.s3.PutObject: calling handler <function add_expect_header at 0xffff843c7160>
2023-07-01 23:35:24:DEBUG:Adding expect 100 continue header to request.
2023-07-01 23:35:24:DEBUG:Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0xffff843c48b0>
2023-07-01 23:35:24:DEBUG:Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0xffff843c84c0>
2023-07-01 23:35:24:DEBUG:Making request for OperationModel(name=PutObject) with params: {'url_path': '/weather-reports/2023-07-01/6-PM', 'query_string': {}, 'method': 'PUT', 'headers': {'x-amz-acl': 'private', 'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'Content-MD5': 'XVqmk+cD6Xh3OpPx++bQMg==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0xffff82ac2c70>, 'auth_path': '/staging-data-ab/weather-reports/2023-07-01/6-PM', 'url': 'https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/6-PM', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff82b6d0a0>, 'has_streaming_input': True, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'staging-data-ab', 'params': {'Bucket': 'staging-data-ab', 'Key': 'weather-reports/2023-07-01/6-PM', 'Body': <_io.BytesIO object at 0xffff82ac2c70>, 'ACL': 'private'}}}}
2023-07-01 23:35:24:DEBUG:Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff82b6d0d0>>
2023-07-01 23:35:24:DEBUG:Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffff835e5d30>>
2023-07-01 23:35:24:DEBUG:Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0xffff843c4af0>
2023-07-01 23:35:24:DEBUG:Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0xffff843c8d30>
2023-07-01 23:35:24:DEBUG:Calculating signature using v4 auth.
2023-07-01 23:35:24:DEBUG:CanonicalRequest:
PUT
/weather-reports/2023-07-01/6-PM

content-md5:XVqmk+cD6Xh3OpPx++bQMg==
host:staging-data-ab.s3.amazonaws.com
x-amz-acl:private
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20230701T233524Z

content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2023-07-01 23:35:24:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T233524Z
20230701/us-east-1/s3/aws4_request
9c08cd6692ac9dc5693bb1bd96c0a74db33fc3c2b1f72e043736db517d89bd2b
2023-07-01 23:35:24:DEBUG:Signature:
ae6499f9b35f93e6493faa0d4109d342a7a2d265e64c787d3d289acfe05ee32b
2023-07-01 23:35:24:DEBUG:Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0xffff843c8b80>
2023-07-01 23:35:24:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/6-PM, headers={'x-amz-acl': b'private', 'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'Content-MD5': b'XVqmk+cD6Xh3OpPx++bQMg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20230701T233524Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date, Signature=ae6499f9b35f93e6493faa0d4109d342a7a2d265e64c787d3d289acfe05ee32b', 'amz-sdk-invocation-id': b'f9458988-1932-426a-b217-4716fb80de3b', 'amz-sdk-request': b'attempt=1', 'Content-Length': '2272'}>
2023-07-01 23:35:24:DEBUG:Certificate path: /usr/local/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 23:35:24:DEBUG:Starting new HTTPS connection (1): staging-data-ab.s3.amazonaws.com:443
2023-07-01 23:35:24:DEBUG:Waiting for 100 Continue response.
2023-07-01 23:35:24:DEBUG:100 Continue response seen, now sending request body.
2023-07-01 23:35:24:DEBUG:https://staging-data-ab.s3.amazonaws.com:443 "PUT /weather-reports/2023-07-01/6-PM HTTP/1.1" 200 0
2023-07-01 23:35:24:DEBUG:Response headers: {'x-amz-id-2': 'HJASWC4Nbz4sBnt3OU9TjLzHvIwYgwuKUWZbbrtk2qCiji7t7x0oMZn8C0SAxODkA0MOA4Oi50s=', 'x-amz-request-id': '3T4JC5HDED2Z168F', 'Date': 'Sat, 01 Jul 2023 23:35:25 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"5d5aa693e703e978773a93f1fbe6d032"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 23:35:24:DEBUG:Response body:
b''
2023-07-01 23:35:24:DEBUG:Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0xffff82aaaa60>
2023-07-01 23:35:24:DEBUG:No retry needed.
2023-07-01 23:35:24:DEBUG:Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff82aaaac0>>
2023-07-01 23:37:35:INFO::fetch_most_populated_zipcodes::Query zipcodes_info to fetch most populated zipcodes in a county, converts to Series and returns it
2023-07-01 23:37:35:INFO::get_weather_db_conn::Initiate SQL Alchemy Engine with configuration and returns it
2023-07-01 23:37:35:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:37:35:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:37:35:INFO::get_weather_db_conn::Completed with results <class 'sqlalchemy.engine.base.Engine'>.
2023-07-01 23:37:41:INFO::fetch_most_populated_zipcodes::Completed with results <class 'pandas.core.series.Series'>.
2023-07-01 23:37:41:INFO::fetch_weather_reports::Takes a Series of zipcodes, and HTTP requests Session to make API get call for each zipcode, returns a list of
     dictionary containing weather_reports.
2023-07-01 23:37:41:INFO::get_weather_api_session:: Fetch requests.session() object
2023-07-01 23:37:41:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:37:41:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:37:41:INFO::get_weather_api_session::Completed with results <class 'requests.sessions.Session'>.
2023-07-01 23:37:41:DEBUG:Starting new HTTPS connection (1): weatherapi-com.p.rapidapi.com:443
2023-07-01 23:37:41:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99661 HTTP/1.1" 200 None
2023-07-01 23:37:41:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99692 HTTP/1.1" 200 None
2023-07-01 23:37:41:DEBUG:https://weatherapi-com.p.rapidapi.com:443 "GET /current.json?q=99504 HTTP/1.1" 200 None
2023-07-01 23:37:41:INFO::fetch_weather_reports::Completed with results <class 'list'>.
2023-07-01 23:37:41:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:37:41:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:37:41:INFO::__decrypt::Decrypt the encrypted password using provided key and returns string type password
2023-07-01 23:37:41:INFO::__decrypt::Completed with results <class 'str'>.
2023-07-01 23:37:41:DEBUG:Changing event name from creating-client-class.iot-data to creating-client-class.iot-data-plane
2023-07-01 23:37:41:DEBUG:Changing event name from before-call.apigateway to before-call.api-gateway
2023-07-01 23:37:41:DEBUG:Changing event name from request-created.machinelearning.Predict to request-created.machine-learning.Predict
2023-07-01 23:37:41:DEBUG:Changing event name from before-parameter-build.autoscaling.CreateLaunchConfiguration to before-parameter-build.auto-scaling.CreateLaunchConfiguration
2023-07-01 23:37:41:DEBUG:Changing event name from before-parameter-build.route53 to before-parameter-build.route-53
2023-07-01 23:37:41:DEBUG:Changing event name from request-created.cloudsearchdomain.Search to request-created.cloudsearch-domain.Search
2023-07-01 23:37:41:DEBUG:Changing event name from docs.*.autoscaling.CreateLaunchConfiguration.complete-section to docs.*.auto-scaling.CreateLaunchConfiguration.complete-section
2023-07-01 23:37:41:DEBUG:Changing event name from before-parameter-build.logs.CreateExportTask to before-parameter-build.cloudwatch-logs.CreateExportTask
2023-07-01 23:37:41:DEBUG:Changing event name from docs.*.logs.CreateExportTask.complete-section to docs.*.cloudwatch-logs.CreateExportTask.complete-section
2023-07-01 23:37:41:DEBUG:Changing event name from before-parameter-build.cloudsearchdomain.Search to before-parameter-build.cloudsearch-domain.Search
2023-07-01 23:37:41:DEBUG:Changing event name from docs.*.cloudsearchdomain.Search.complete-section to docs.*.cloudsearch-domain.Search.complete-section
2023-07-01 23:37:41:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/endpoints.json
2023-07-01 23:37:41:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/sdk-default-configuration.json
2023-07-01 23:37:41:DEBUG:Event choose-service-name: calling handler <function handle_service_name_alias at 0xffff85cf9670>
2023-07-01 23:37:41:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/service-2.json
2023-07-01 23:37:41:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/s3/2006-03-01/endpoint-rule-set-1.json.gz
2023-07-01 23:37:41:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/partitions.json
2023-07-01 23:37:41:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_post at 0xffff85d56430>
2023-07-01 23:37:41:DEBUG:Event creating-client-class.s3: calling handler <function lazy_call.<locals>._handler at 0xffff84f36160>
2023-07-01 23:37:41:DEBUG:Event creating-client-class.s3: calling handler <function add_generate_presigned_url at 0xffff85d561f0>
2023-07-01 23:37:41:DEBUG:Setting s3 timeout as (120, 120)
2023-07-01 23:37:41:DEBUG:Loading JSON file: /usr/local/airflow/.local/lib/python3.8/site-packages/botocore/data/_retry.json
2023-07-01 23:37:41:DEBUG:Registering retry handlers for service: s3
2023-07-01 23:37:41:DEBUG:Registering S3 region redirector handler
2023-07-01 23:37:41:DEBUG:Event before-endpoint-resolution.s3: calling handler <function customize_endpoint_resolver_builtins at 0xffff85c95d30>
2023-07-01 23:37:41:DEBUG:Event before-endpoint-resolution.s3: calling handler <bound method S3RegionRedirectorv2.redirect_from_cache of <botocore.utils.S3RegionRedirectorv2 object at 0xffff843fca30>>
2023-07-01 23:37:41:DEBUG:Calling endpoint provider with parameters: {'Bucket': 'staging-data-ab', 'Region': 'us-east-1', 'UseFIPS': False, 'UseDualStack': False, 'ForcePathStyle': False, 'Accelerate': False, 'UseGlobalEndpoint': True, 'DisableMultiRegionAccessPoints': False, 'UseArnRegion': True}
2023-07-01 23:37:41:DEBUG:Endpoint provider result: https://staging-data-ab.s3.amazonaws.com
2023-07-01 23:37:41:DEBUG:Selecting from endpoint provider's list of auth schemes: "sigv4". User selected auth scheme is: "None"
2023-07-01 23:37:41:DEBUG:Selected auth type "v4" as "v4" with signing context params: {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_ascii_metadata at 0xffff85c949d0>
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function sse_md5 at 0xffff85c91dc0>
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function convert_body_to_file_like_object at 0xffff85c95310>
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function validate_bucket_name at 0xffff85c91d30>
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function remove_bucket_from_url_paths_from_model at 0xffff85c95b80>
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.annotate_request_context of <botocore.utils.S3RegionRedirectorv2 object at 0xffff843fca30>>
2023-07-01 23:37:41:DEBUG:Event before-parameter-build.s3.PutObject: calling handler <function generate_idempotent_uuid at 0xffff85c91b80>
2023-07-01 23:37:41:DEBUG:Event before-call.s3.PutObject: calling handler <function conditionally_calculate_md5 at 0xffff85e1d5e0>
2023-07-01 23:37:41:DEBUG:Event before-call.s3.PutObject: calling handler <function add_expect_header at 0xffff85c940d0>
2023-07-01 23:37:41:DEBUG:Adding expect 100 continue header to request.
2023-07-01 23:37:41:DEBUG:Event before-call.s3.PutObject: calling handler <function add_recursion_detection_header at 0xffff85c91820>
2023-07-01 23:37:41:DEBUG:Event before-call.s3.PutObject: calling handler <function inject_api_version_header_if_needed at 0xffff85c95430>
2023-07-01 23:37:41:DEBUG:Making request for OperationModel(name=PutObject) with params: {'url_path': '/weather-reports/2023-07-01/06-PM', 'query_string': {}, 'method': 'PUT', 'headers': {'x-amz-acl': 'private', 'User-Agent': 'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'Content-MD5': 'XVqmk+cD6Xh3OpPx++bQMg==', 'Expect': '100-continue'}, 'body': <_io.BytesIO object at 0xffff8440fef0>, 'auth_path': '/staging-data-ab/weather-reports/2023-07-01/06-PM', 'url': 'https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/06-PM', 'context': {'client_region': 'us-east-1', 'client_config': <botocore.config.Config object at 0xffff8443a0a0>, 'has_streaming_input': True, 'auth_type': 'v4', 'signing': {'region': 'us-east-1', 'signing_name': 's3', 'disableDoubleEncoding': True}, 's3_redirect': {'redirected': False, 'bucket': 'staging-data-ab', 'params': {'Bucket': 'staging-data-ab', 'Key': 'weather-reports/2023-07-01/06-PM', 'Body': <_io.BytesIO object at 0xffff8440fef0>, 'ACL': 'private'}}}}
2023-07-01 23:37:41:DEBUG:Event request-created.s3.PutObject: calling handler <bound method RequestSigner.handler of <botocore.signers.RequestSigner object at 0xffff8443a0d0>>
2023-07-01 23:37:41:DEBUG:Event choose-signer.s3.PutObject: calling handler <bound method ClientCreator._default_s3_presign_to_sigv2 of <botocore.client.ClientCreator object at 0xffff84eafd30>>
2023-07-01 23:37:41:DEBUG:Event choose-signer.s3.PutObject: calling handler <function set_operation_specific_signer at 0xffff85c91a60>
2023-07-01 23:37:41:DEBUG:Event before-sign.s3.PutObject: calling handler <function remove_arn_from_signing_path at 0xffff85c95ca0>
2023-07-01 23:37:41:DEBUG:Calculating signature using v4 auth.
2023-07-01 23:37:41:DEBUG:CanonicalRequest:
PUT
/weather-reports/2023-07-01/06-PM

content-md5:XVqmk+cD6Xh3OpPx++bQMg==
host:staging-data-ab.s3.amazonaws.com
x-amz-acl:private
x-amz-content-sha256:UNSIGNED-PAYLOAD
x-amz-date:20230701T233741Z

content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date
UNSIGNED-PAYLOAD
2023-07-01 23:37:41:DEBUG:StringToSign:
AWS4-HMAC-SHA256
20230701T233741Z
20230701/us-east-1/s3/aws4_request
4a4b9e9d93c3f7c67b0ff54bf148f16af252fa86c48c4f7c985e97e01a5ba631
2023-07-01 23:37:41:DEBUG:Signature:
34e67d64b3e207155932029449491ce2d9696a03caa297a45c0810d6c859fcc2
2023-07-01 23:37:41:DEBUG:Event request-created.s3.PutObject: calling handler <function add_retry_headers at 0xffff85c95af0>
2023-07-01 23:37:41:DEBUG:Sending http request: <AWSPreparedRequest stream_output=False, method=PUT, url=https://staging-data-ab.s3.amazonaws.com/weather-reports/2023-07-01/06-PM, headers={'x-amz-acl': b'private', 'User-Agent': b'Boto3/1.26.125 Python/3.8.9 Linux/5.15.49-linuxkit Botocore/1.29.125', 'Content-MD5': b'XVqmk+cD6Xh3OpPx++bQMg==', 'Expect': b'100-continue', 'X-Amz-Date': b'20230701T233741Z', 'X-Amz-Content-SHA256': b'UNSIGNED-PAYLOAD', 'Authorization': b'AWS4-HMAC-SHA256 Credential=AKIAXI4BC3FXUKYJKHBB/20230701/us-east-1/s3/aws4_request, SignedHeaders=content-md5;host;x-amz-acl;x-amz-content-sha256;x-amz-date, Signature=34e67d64b3e207155932029449491ce2d9696a03caa297a45c0810d6c859fcc2', 'amz-sdk-invocation-id': b'd209fddd-5985-4a39-98df-9ab774becf06', 'amz-sdk-request': b'attempt=1', 'Content-Length': '2272'}>
2023-07-01 23:37:41:DEBUG:Certificate path: /usr/local/lib/python3.8/site-packages/certifi/cacert.pem
2023-07-01 23:37:41:DEBUG:Starting new HTTPS connection (1): staging-data-ab.s3.amazonaws.com:443
2023-07-01 23:37:42:DEBUG:Waiting for 100 Continue response.
2023-07-01 23:37:42:DEBUG:100 Continue response seen, now sending request body.
2023-07-01 23:37:42:DEBUG:https://staging-data-ab.s3.amazonaws.com:443 "PUT /weather-reports/2023-07-01/06-PM HTTP/1.1" 200 0
2023-07-01 23:37:42:DEBUG:Response headers: {'x-amz-id-2': 'Po6cNxE654PgyPG9OqHuiAitw66YBFtfj8du5qTzq4AhiJ2YDEZpr0UiWt6cbZfWwxn8ml01McA=', 'x-amz-request-id': '64QH0162SMJV2Q0F', 'Date': 'Sat, 01 Jul 2023 23:37:43 GMT', 'x-amz-server-side-encryption': 'AES256', 'ETag': '"5d5aa693e703e978773a93f1fbe6d032"', 'Server': 'AmazonS3', 'Content-Length': '0'}
2023-07-01 23:37:42:DEBUG:Response body:
b''
2023-07-01 23:37:42:DEBUG:Event needs-retry.s3.PutObject: calling handler <botocore.retryhandler.RetryHandler object at 0xffff843fc9d0>
2023-07-01 23:37:42:DEBUG:No retry needed.
2023-07-01 23:37:42:DEBUG:Event needs-retry.s3.PutObject: calling handler <bound method S3RegionRedirectorv2.redirect_from_error of <botocore.utils.S3RegionRedirectorv2 object at 0xffff843fca30>>
